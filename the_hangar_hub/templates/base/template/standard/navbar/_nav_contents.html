{% load base_taglib %}

{%if include_home%}
    <li>
        <a class="dropdown-item" href="/">Home</a>
    </li>
    <li class="dropdown-divider"></li>
{%endif%}


{% if not user.is_authenticated%}
<li class="dropdown-header">
        Public Services
    </li>
    <a href="{%url 'account_login'%}" class="dropdown-item">Log In</a>
    <a href="{%url 'account_signup'%}" class="dropdown-item">Create Account</a>
{%endif%}


{% if user.is_authenticated and is_a_tenant%}
    <li class="dropdown-header">
        Tenant Services
    </li>
    <li>
        <a href="{%url 'application:dashboard'%}" class="dropdown-item">Hangar Applications</a>
    </li>
    <li>
        <a href="{%url 'rent:dashboard'%}" class="dropdown-item">Payment Dashboard</a>
    </li>
    <li class="dropdown-header">
        My Hangars
    </li>
    {%for rental in my_rentals%}
    <li>
        <a href="{%url 'rent:hangar' rental.hangar.building.airport.identifier rental.hangar.code%}" class="dropdown-item">{{rental.hangar}}</a>
    </li>
    {%endfor%}
{%endif%}


{%if 'administrator'|has_authority:True%}

    <li class="dropdown-divider"></li>

    <li class="dropdown-header">
        Administration
    </li>

    <li>
        <a href="{%url 'administration:invitation_dashboard'%}" class="dropdown-item">Invitation Dashboard</a>
    </li>

{%endif%}

{% if user.is_authenticated%}




    {%if managed_airports%}

    <li class="dropdown-divider"></li>

    <li class="dropdown-header">
        Management Services
    </li>

        {%for airport in managed_airports%}
            <li class="dropdown-header">
                Administration: {{airport.identifier}}
            </li>

            <li>
                <a href="{%url 'application:mgmt_dashboard' airport.identifier%}" class="dropdown-item">
                    Application Dashboard
                    {%with unreviewed_applications=airport.get_unreviewed_applications%}
                        {%if unreviewed_applications%}
                            <span class="badge text-bg-danger">{{unreviewed_applications|length}}</span>

                        {%endif%}
                    {%endwith%}
                </a>
            </li>


            <li>
                <a href="{%url 'airport:airport' airport.identifier%}" class="dropdown-item">Manage Airport</a>
            </li>
            <li>
                <a href="{%url 'infrastructure:buildings' airport.identifier%}" class="dropdown-item">Manage Hangars</a>
            </li>
            <li>
                <a href="{%url 'rent:rent_collection_dashboard' airport.identifier%}" class="dropdown-item">Rent Collection</a>
            </li>
            <li>
                <a href="{%url 'application:preferences' airport.identifier%}" class="dropdown-item">Application Preferences</a>
            </li>

            <li>
                <span class="dropdown-item">Waitlist</span>
            </li>
        {%endfor%}
    {%endif%}
{%endif%}
