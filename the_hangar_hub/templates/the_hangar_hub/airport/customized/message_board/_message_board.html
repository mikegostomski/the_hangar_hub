{% load base_taglib %}
<div id="airport-message-board">


    <div class="accordion" id="messageBoard">
    {%for thread in airport.message_board_topics%}
        <div class="accordion-item">
            <b class="accordion-header" id="heading{{ forloop.counter }}">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#collapse{{ forloop.counter }}" aria-expanded="false"
                    aria-controls="collapse{{ forloop.counter }}"
                >
                    {{ thread.topic }}
                </button>
            </b>
            <div id="collapse{{ forloop.counter }}" class="accordion-collapse collapse"
                aria-labelledby="heading{{ forloop.counter }}" data-bs-parent="#messageBoard"
            >
                <div class="accordion-body">
                    {%include "the_hangar_hub/airport/customized/message_board/_message_group.html" with message_group=thread.posts%}
                </div>
            </div>
        </div>
    {% empty %}
        <p class="text-muted">No message board threads available.</p>
    {%endfor%}

    </div>
    <br />

    <button type="button" class="btn btn-secondary" onclick="$('#mb-new-container').removeClass('hidden').find('input[name=mb_topic]').trigger('focus');">
        Start a New Thread
    </button>
    <div class="content-800 popup hidden" id="mb-new-container">
        <form method="post" action="{%url 'airport:message_board_post' airport.identifier%}">
            {%csrf_token%}
            <div class="form-floating mb-3">
                <input type="text" id="mb_topic" name="mb_topic" maxlength="100" class="form-control" placeholder=" " />
                <label for="mb_topic">Message Board Topic</label>
            </div>
            <div class="form-floating mb-3">
                <textarea id="mb_content" name="mb_content" class="form-control" placeholder=" " style="min-height:200px;"></textarea>
                <label for="mb_content">Message Board Content</label>
            </div>
            <div class="text-center">
                <button type="button" class="btn btn-secondary" onclick="$(this).closest('.popup').addClass('hidden');">Cancel</button>
                <button type="submit" class="btn btn-primary">Post</button>
            </div>
        </form>
    </div>
    <div class="content-800 popup hidden" id="mb-response-container">
        <form method="post" action="{%url 'airport:message_board_post' airport.identifier%}">
            {%csrf_token%}
            <input type="hidden" name="response_to" value="" />
            <div class="source"></div>

            <div class="form-floating mb-3">
                <textarea id="mb_reply" name="mb_content" class="form-control" placeholder=" " style="min-height:200px;"></textarea>
                <label for="mb_reply">Reply Content</label>
            </div>
            <div class="text-center">
                <button type="button" class="btn btn-secondary" onclick="$(this).closest('.popup').addClass('hidden');">Cancel</button>
                <button type="submit" class="btn btn-primary">Post</button>
            </div>
        </form>
    </div>
</div>
<script type="text/javascript">
    {%include "the_hangar_hub/airport/customized/message_board/mb_script.js"%}
</script>