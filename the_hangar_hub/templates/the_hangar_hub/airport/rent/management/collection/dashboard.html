{% extends 'base/template/standard/template.html' %}
{% load base_taglib %}

{%block title%}Rental Payment Dashboard{%endblock%}
{%block scripts%}{%datatables%}{%endblock%}

{% block main_content %}
<h1>Rental Payment Dashboard</h1>
<br />

<h2>Current Rental Agreements</h2>
<section>
    <table class="table" id="current_rental_agreements_table">
        <thead>
        <tr>
            <th scope="row">Hangar</th>
            <th scope="row">Tenant</th>
            <th scope="row">Rent</th>
            <th scope="row">Paid Through</th>
            <th scope="row">Balance</th>
        </tr>
        </thead>
        <tbody>
        {%for rental in rentals%}
        {%with subscription=rental.get_stripe_subscription_model%}
        <tr>
            <td><a href="{%url 'rent:rental_invoices' airport.identifier rental.id%}">{{rental.hangar.code}}</a></td>
            <td>{{rental.tenant.display_name}}</td>
            <td>{%format_currency rental.rent%}</td>
            <td>{%humanized_date rental.paid_through_date%}</td>
            <td>
                <i class="hidden">{{rental.unpaid_balance}}</i>
                {%if rental.paid_through_date >= now%}
                    <span class="badge balance text-bg-success">{%format_currency rental.unpaid_balance%}</span>
                {%elif rental.paid_through_date >= airport.today%}
                    <span class="badge balance text-bg-warning">{%format_currency rental.unpaid_balance%}</span>
                {%else%}
                    <span class="badge balance text-bg-danger">{%format_currency rental.unpaid_balance%}</span>
                {%endif%}
            </td>
        </tr>
        {%endwith%}
        {%endfor%}
        </tbody>
    </table>
</section>

<script type="text/javascript">
    {%include "the_hangar_hub/airport/rent/management/collection/script.js"%}
</script>
<style>
    span.balance{
        display: inline-block;
        width: 100px;
        text-align: right;
        font-family: monospace;
        font-size: 1em;
        font-weight: normal;
    }
</style>
{%endblock%}